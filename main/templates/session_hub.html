{% extends 'base.html' %}

{% block content %}
<h2>SessionHub</h2>

<!-- Form to Create a Session -->
<div>
    <h3>Create Session</h3>
    <form method="POST">
        {% csrf_token %}
        <label for="title">Title:</label>
        <input type="text" name="title" required>

        <label for="purpose">Purpose:</label>
        <select name="purpose" required>
            <option value="Academics">Academics</option>
            <option value="CodeSesh">CodeSesh</option>
            <option value="Other">Other</option>
        </select>

        <label for="branch">Branch:</label>
        <select name="branch" required>
            <option value="CSE Core">CSE Core</option>
            <option value="CSE+Spec">CSE+Spec</option>
            <option value="ECE">ECE</option>
            <option value="EEE">EEE</option>
            <option value="Mechanical">Mechanical</option>
            <option value="Civil">Civil</option>
        </select>

        <label for="start_date">Start Date:</label>
        <input type="date" name="start_date" required>

        <label for="start_time">Start Time:</label>
        <input type="time" name="start_time" required>

        <label for="end_date">End Date:</label>
        <input type="date" name="end_date" required>

        <label for="end_time">End Time:</label>
        <input type="time" name="end_time" required>

        <button type="submit">Create Session</button>
    </form>
</div>

<!-- Display My Sessions -->
<div>
    <h3>My Sessions</h3>
    <ul>
        {% for session in my_sessions %}
        <li>
            {{ session.title }} - {{ session.purpose }} - {{ session.branch }}
            <form method="POST" action="{% url 'delete_session' session.id %}">
                {% csrf_token %}
                <button type="submit">Delete</button>
            </form>
        </li>
        {% empty %}
        <li>No sessions available.</li>
        {% endfor %}
    </ul>
</div>

<!-- Display All Sessions -->
<div>
    <h3>All Sessions</h3>
    <ul>
        {% for session in all_sessions %}
        <li>
            {{ session.title }} - {{ session.purpose }} - {{ session.branch }}
            
            <!-- Form to message the session creator -->
            {% if request.user != session.user %}
            <form method="POST" action="{% url 'send_message_to_user' session.user.id %}">
                {% csrf_token %}
                <input type="text" name="message" placeholder="Type your message..." required>
                <button type="submit">Message Creator</button>
            </form>
            {% else %}
            <p>You cannot message yourself (session creator).</p>
            {% endif %}
        </li>
        {% empty %}
        <li>No sessions available.</li>
        {% endfor %}
    </ul>
</div>
{% endblock %}
